# 数字信号处理--使用matlab

> 平时30%+期末70%

[TOC]

### #0 绪论

##### 0.1 信号、系统及信号处理

- 信号：信息的物理表现。可分类为一维/二维、周期/非周期、确定/随机、能量/功率、连续时间\离散时间\数字信号

- 系统：处理信号的物理设备

- 数字信号处理系统的基本组成（模拟、数字信号）

  ```
  模拟输入信号》模拟信号处理器》模拟输出信号
  ```

  ```
  模拟信号输入》A/D转换器》数字信号处理器》D/A转换器》模拟信号输出
  ```

- 数字信号处理与模拟信号处理相比的优点

  - 灵活：不需要更改硬件，只需更改程序
  - 精度、易存储、易大规模集成、时分复用

[TOC]

### #1 离散时间信号与系统

##### 1.1 离散时间信号--序列

- 离散时间信号：只在离散时间上给出函数值，是时间上不连续的序列，使用`X(n)`表示序列，仅n为整数时有意义
- 考试要求：序列要如下标出坐标0

> X(n) = {-2,-1,0,1,2,3}
>
> ​					  ↑

- 离散信号的周期

  - 周期N = $\frac{2\pi}{\omega_0}k$ 

  > 例：cos$\frac{3\pi}{8}n$ 
  >
  > ------
  >
  > N = $\frac{2\pi}{3\pi/8}k = \frac{16}{3}k$ = 16，令k=3即可

- 序列的运算

  - 移位、翻转、和、积（点乘）、累加（表示n~0~点上，之前的所有序列X(n)及该店X(n~0~)和）、差分运算（向前、向后）、抽样（X(an)）、序列的时间尺度变换（抽取与零值插入）、卷积和

  > 例：已知离散时间信号x[k]，画出x[-3k+2]的图像
  >
  > ------
  >
  > x[k] >> x[k+2] >> x[-3k+2]               先左移再抽样再翻转

- 卷积

  - y(t) = f(t) * h(t) = $\int^∞_{-∞}$f(τ)h(t-τ)dτ​

  - y(t) = f(t) * h(t) = $\sum^\infin_{k=-\infin}$ x(k)h(n-k)

  - >技巧》
    >
    >a[x] = [1,2,**0**,3,2]	b[x] = [1 **4** 2 3]
    >
    >​		 1 2 0 3 2
    >
    >​        *  1 4 2 3
    >
    >------
    >
    >​		 3 6 0 9 6
    >
    >​	  2 4 0 6 4
    >
    >     4 8 0 12 8
    >
    >1 2 0 3 2
    >
    >------
    >
    >相乘后相加得到结果
    >
    >y[k] = [1,6,10,**10**,20,14,13,6]

> 例1：x(n) = u(n) - u(n-10)
>
> h(n) = (0.9)^n^u(n)
>
> ------
>
> 解：y(n) = x(n)*h(n)
>
> = $\sum^\infin_{k=-\infin}$ x(k)h(n-k)
>
> = $\sum^9_{k=0}$ (0.9)^n-k^u(n-k)			接下来分类讨论
>
> =y(n) = $\left\{\begin{aligned}0,n<0\\ (0.9)^n\sum^n_{k=0}(0.9)^{-k},0<=n<9\\(0.9)^n\sum^9_{k=0}(0.9)^{-k},n>=9\end{aligned}\right.$ 

- 关联（相关）

  - 互相关

    r~x,y~(l) = $\sum^{+\infin}_{n=-\infin}$x(n)y(n-l)

  - 自相关

    r~x,y~(l) = $\sum^{+\infin}_{n=-\infin}$x(n)x(n-l)

    - 索引l称为偏移或延迟函数

- 几种常用序列

  - 单位抽样序列δ(n)

    $δ(n) = \left\{\begin{aligned}1, n=0\\0,n≠0\end{aligned}\right.$ 

  - 单位阶跃序列u(n)

    $u(n) = \left\{\begin{aligned}1, n≥0\\0,n<0\end{aligned}\right.$ 

  - 矩形序列R~N~(n)

    $R_N(n) = \left\{\begin{aligned}1, 0≤n≤N-1\\0,其他n\end{aligned}\right.$

  - 实指数序列x(n) = a^n^u(n)

    - 其中a为实数，当|a|<1时，序列收敛，大于1时发散

  - 几何序列（等比数列）a^n^

    - $\sum^\infin_{n=0}$a^n^ → $\frac{1}{1-a}$, |a|<1。当且仅当|a|<1时收敛
    - $\sum^{N-1}_{n=0}$a^n^ → $\frac{1-a^N}{1-a}$, |a|<1

  - 复指数序列、正弦型序列

- 序列的周期性

  - 如果对所有n存在一个最小正整数N，满足x(n) = x(n+N)，则称序列x(n)是周期性序列，周期为N

- 用单位抽样序列来表示任意序列（使用卷积）

- 序列的能量E：定义为序列各抽样值的平方和



##### 1.2 线性移不变LSI系统

- 系统 y(n) = T[x(n)]
  - 激励，输入信号 x(n)
  - 响应，输出信号 y(n)
  - 零输入响应：输入x(n) = 0时y(n)的输出
- 线性系统：满足叠加原理的系统称为线性系统
- 移不变系统（时不变）：系统响应与激励加于系统的时刻无关，也就是说，输入输出的运算关系不随时间而变化
  - 若T[x(n)] = y(n)，则T[x(n-m)] = y(n-m)
- 因果系统：某时刻的输出只取决于此时刻以及以前时刻的输入的系统（不取决于未来）
  - LSI系统是因果系统的充分必要条件：h(n) = 0, n<0
- 稳定系统：系统能正常工作的先决条件。稳定系统是指有界输入产生有界输出的系统
  - 条件：$\sum_{n=-\infin}^{+\infin}|h(n)| < \infin$ 
  - 因果稳定的LSI系统的单位抽样响应是因果的且是绝对可和的
- 线性移不变系统的性质
  - 交换律：卷积运算序列互换结果一样
  - 结合律、分配律

> 例：判断以下系统是否线性、时不变、因果、稳定的？
>
> 1）T[x(n)] = g(n)x(n)
>
> 2）T[x(n)] = e^x(n)^
>
> ------
>
> 解：1、
>
> T[ax~1~(n)+bx~2~(n)] = g(n)[ax~1~(n)+bx~2~(n)] = aT[x~1~(n)]+b[x~2~(n)]	>>线性
>
> T[x(n-m)] = g(n)x(n-m) ≠ y(n-m) = g(n-m)x(n-m)			>>时变的
>
> \>>显然因果
>
> \>>若g(n)有界，则y(n)有界，系统稳定；反之不稳定
>
> 
>
> 2、
>
> T[ax~1~(n)+bx~2~(n)] = e^ax1(n)+ax2(n)^ = e^ax1(n)^e^ax2(n)^	>>非线性
>
> \>>时不变，因果
>
> 设|x(n)|<M，则e^-M^<e^x(n)^<e^M^<∞	>>稳定

- 单位冲激响应h(n)（单位抽样响应）
  - LTI系统可用h(n)来表示
  - y(n) = x(n)*h(n)
    - x(n) = $\sum_{m=-\infin}^{\infin}x(m)\delta(n-m)$ 
    - y(n) = $\sum_{m=-\infin}^{\infin}x(m)h(n-m)$ 
  - 因果与稳定的判断
    - 因果：当n<0时，h(n) = 0
    - 稳定：$\sum_{n=-\infin}^{\infin}$|h(n)| ≠ ∞



##### 1.3 常系数线性差分方程

- $\sum^N_{k=0}$a~k~y(n-k) = $\sum^N_{m=0}$b~m~y(n-m)
  - 输出y(n) = $\sum^N_{m=0}$b~m~y(n-m) - $\sum^N_{k=1}$a~k~y(n-k)
- 求解方法
  - 序列域求解法，包括经典解法、卷积和计算法、迭代法（递推）。以下使用递推
  - 变换域求解法

> 例》常系数线性差分方程y(n) = ay(n-1) + x(n)，初始状态y(-1)= 0
>
> ------
>
> 解：	令x(n) = δ(n)
>
> ​			y(0) = ay(-1) + δ(0) = 1,	y(1) = ay(0) + δ(1) = a
>
> ​			y(2) = a^2^,		y(3) = a^3^
>
> 得出结论：y(n) = a^n^u(n)

##### 1.4 模拟信号的采样与重建

- 通过采样和量化把真实世界的模拟信号转化为离散信号
- 抽样：可以看成是一个电子开关，每个T秒闭合一次
  - 频谱发生的变化：时域相乘，则频域（傅里叶变换域）为卷积运算
- 采样频率的限制
  - 要使得采样后不失真，必须实现f~采样频率~ ≥ 2f~信号谱的最高频率~ （奈奎斯特抽样定理）

- 模拟角频率Ω与数字角频率ω的关系：ω = ΩT
- 信号在时域离散化，则频域周期延拓化
- 信号的重建（抽样的恢复）
  - 采用低通滤波器得到不失真的原信号频谱
  - 使用时域内插卷积/频域相乘重建信号 Y~a~(jΩ) = X~a~(jΩ) H(jΩ)
    - X~a~(jΩ)：采样信号频谱
    - H(jΩ)：滤波器
- 内插
  - 0阶保持内插ZOH
    - 阶梯形

  - 一阶保持内插FOH
    - 相邻样本由直线相连

  - 三次样条内插COH
    - 使用样条内插器作为平滑器


[TOC]

### #2 z变换于离散时间傅里叶变换DTFT

> 信号与系统的分析方法除时域分析外，还有变换域分析方法。在连续时间信号与系统中，变换域方法是拉普拉斯变换和傅里叶变换。在离散时间信号与系统中，变换域分析方法是z变换法和傅里叶变换法

##### 2.1 z变换的定义与收敛域

- 与DTFT相比之下
  - DTFT存在条件是x(n)绝对可和。部分信号不存在DTFT
  - 初始条件或输入的变换引起的瞬时响应DTFT不能计算

- 对于序列x(n)，有幂级数X(z) = $\sum^\infin_{n=-\infin}$x(n)z^-n^
  - 仅当X(z)收敛时，z变换才有意义
  - 级数收敛的必要且充分条件：|X(z)| = M < ∞
- 收敛域ROC
  - 有限长序列：指在有限区间n~1~<=n<=n~2~之内才具有非零的有限值，在此区间外，序列皆为0
  - 右边序列：只在n>=n~1~时，x(n)有值
  - 左边序列、双边序列：左边序列与右边序列之和
  - ROC不包括极点
- 极点与零点
  - 极点为令Z变换等式无穷大的z值
  - 零点为令Z变换等式等于0的z值
  - 幅频响应在极点附近出现峰值，在零点附近出现谷值
  - z-平面表示
    - 零点用圆圈表示
    - 极点用x表示
- 系统函数H(z)
  - 当且仅当单位圆在ROC内，LTI系统是稳定的，此时存在DTFT
  - 当且仅当H(z)的所有极点均在单位圆内时，因果LTI系统稳定
  - 因果系统的ROC在某些圆之外


##### 2.2 z反变换

- 常用：部分分式展开法
- $Z^{-1}[\frac{z}{z-P_k}] = \left\{\begin{aligned}P^n_ku(n), |Z_k|<=Rx_-\\-P^n_ku(-n-1), |Z_k|<=Rx_+\end{aligned}\right.$ 
  - Z~k~为极点

##### 2.3 z变换的基本性质和定理

- 线性
- 线性加权
  - 若X(z) = Z[x(n)]，则有Z[nx(n)] = -z·$\frac{dX(z)}{dz}$ 

##### 2.5 DTFT

> 离散时间傅里叶变换 

- 对于LTI系统，DTFT表示方式是最优的。基于复指数信号集{e^jωn^}

- X(e^jω^) = DTFT[x(n)] = $\sum^\infin_{n=-\infin}$x(n) e^-jωn^

  - 存在条件：x(n)绝对可和

- 时域是离散的，故频域特性一定是周期的（周期延拓）

- 逆变换

  x(n) = IDTFT[X(e^jω^)] = $\frac{1}{2\pi}\int^\pi_{-\pi}$X(e^jω^)e^jωn^dω

- H(e^jω^)：h(n)的DTFT，称为LTI系统的频率响应函数（传输函数）

  - 求差分方程的频率响应函数
    - 对差分方程两边做DTFT
    - H(e^jω^) = $\frac{Y(e^{jω})}{X(e^{jω})}$ 


##### 2.6 DTFT主要性质

- 线性
- 线性加权
  - DTFT[nx(n)] = j$\frac{dX(e^{j\omega})}{d\omega}$ 

- 移位：时域的移位对应于频域有一个相位移
- 乘以指数序列：时域乘以a^n^，对应频域乘以$\frac{1}{a}$
- 乘以复指数序列（如：e^jω0n^）：定义频域ω减去该值
- 时域卷积，频域相乘
- 频域卷积定理：时域的相乘对应于频域周期性卷积并除以2$\pi$
- 帕塞瓦定理（能量）：时域的总能量等于频域的总能量

##### 2.7 周期性序列的DTFT

- 由于n→∞时，周期性序列不趋于0，所以周期序列不是绝对可和的或平方可和的，而它的傅里叶变换也不是一致收敛的或均方收敛的。引入冲激函数δ(ω)后，就可以使得其傅里叶变换存在，这样可以描述周期性序列的频谱特性

##### 2.8 傅里叶变换的一些对称性质

##### 2.9 离散系统的系统函数、系统的频率响应



[TOC]

### #3 离散傅里叶变换 DFT

##### 3.1 引言

- 离散傅里叶变换
  - 可以作为有限长序列的一种傅里叶表示法
  - 存在快速算法：快速傅里叶变换FFT
- 有限长序列的DFT和周期序列的DFS（离散傅里叶级数）本质上一样
- 三种变换
  - DTFT为绝对可和序列提供频率域表示
  - ZT为任意序列提供普遍的频率域表示
  - DFT提供了有限长序列的频率域表示


##### 3.2 傅里叶变换的集中可能形式

- 连续时间、连续频率：傅里叶变换(CTFT)
- 连续时间、离散频率：傅里叶级数
- 离散时间、连续频率：DTFT
- 离散时间、离散谱率：DFT

##### 3.3 周期序列的DFS

- 周期序列不是绝对可和的，所以不能用ZT表示，因为z变换不收敛

- 周期序列可用离散傅里叶级数（DFS）来表示

  - DFS[x(n)] = $\sum_{n=0}^{N-1}x(n)W_N^{nk}$ 
  - W~N~ = $e^{-j\frac{2\pi}{N}}$ 
  - $W_N^{nk} = e^{-j\frac{2\pi}{N}nk}$ 

- 通过DFS获取x(n)的离散频率表示

  > 例：计算序列{**2**，3，3，2}的DFT
  >
  > ------
  >
  > X(e^jω^) = $\sum_{n=-\infin}^\infin x(n)e^{-jωn}$ = 2+ 3e^-jω^ + 3e^-j2ω^ + 2e^-j3ω^ 
  >
  > x[0] = x(e^j0^) = $2W_N^0+3W_N^0+3W_N^0+2W_N^0$ = 10
  >
  > x[1] = x($e^{j\frac{1\times2\pi}{4}}$) = ...
  >
  > x[2] = x($e^{j\frac{2\times2\pi}{4}}$)
  >
  > ...

##### 3.4 DFS性质

##### 3.5 DFT——有限长序列的离散频域表示

- 定义
  - 正变换：X(k) = $\sum^{N-1}_{n=0}x(n)W^{nk}_N$ , 0 ≤ k ≤ N-1
  - 反变换：x(n) = $\frac{1}{N}\sum^{N-1}_{k=0}X(k)W^{-nk}_N$ , 0 ≤ n ≤ N-1
- 凡是说到离散傅里叶变换关系之处，有限长序列都是作为周期序列的一个周期来表示的，都隐含周期性意义

##### 3.6 DFT性质

- 线性

- 序列的圆周移位
  - 先拓展后移位
  - x((n+2))~N~ 左移两位

- 圆周反折
  - 先拓展后反折

- 对偶性

- 圆周共轭对称性

- DFT下的帕塞瓦定理

- 圆周卷积和

  - 不足点数则补零

  > 例：x1(n) = {1,2,2}, x2(n) = {1,2,3,4}
  >
  > 求4点的圆周卷积
  >
  > ------
  >
  > x1(n) ④ x2(n) = 
  >
  > \[1 4 3 2][1]
  >
  > \[2 1 4 3][2]
  >
  > \[3 2 1 4][2] 	=	{15,12,9,14}
  >
  > \[4 3 2 1][0]

- 圆周相关、有限长序列的线性卷积与圆周卷积



[TOC]

### #4 快速傅里叶变换FFT

##### 4.1 引言

- FFT是DFT的一种快速算法

##### 4.2 直接计算DFT的问题及改进途径

- 计算量大
- 利用系数$W^{nk}_N$的特性减小DFT的运算量
  - 共轭对称性
  - 周期性
  - 可约性

##### 4.3 基-2FFT算法

- 按时间抽选DIT
- 按频率抽选DIF



[TOC]

### #5 数字滤波器结构

##### 5.1 数字滤波器结构的表示方法

- 与模拟滤波器类似，数字滤波器按频率特性划分也有低通、高通、带通、带阻、全通等类型
- 一个滤波器可以使用系统函数表示
- 数字滤波器的实现：使用软件、使用硬件
- 描述数字滤波器的基本部件
  - 加法器
  - 乘法器
  - 延时单元

- 滤波器类型
  - IIR：无限长冲激响应


##### 5.2 IIR滤波器的基本结构

- 直接型

  - 直接Ⅰ型
  - 直接Ⅱ型：直接I型合并操作后的结果

  ![直接I型](image\直接型.png)

- 级联型

  - IIR使用二阶节

    $H(z) = \frac{b_0+b_1z^{-1}+...+b_Nz^{-N}}{1+a_1z^{-1}+...+a_Nz^{-N}}\\=b_0\frac{1+\frac{b_1}{b_0}z^{-1}+...+\frac{b_N}{b_0}z^{-N}}{1+a_1z^{-1}+...+a_Nz^{-N}}\\\ =b_0\Pi_{k=1}^K\frac{1+B_{k,1}z^{-1}+B_{k,2}z^{-2}}{1+A_{k,1}z^{-1}+A_{k,2}z^{-2}}$ 

- 并联型

- 转置定理：如果将线性时不变网络中所有支路方向倒转，并将x(n)和输出y(n)相互交换，则其系统函数H(z)不变

##### 5.3 FIR滤波器的基本结构

- 有限长单位冲激响应滤波器FIR
  - 系统单位冲激响应h(n)在有限个n值处不为0
  - 系统函数H(z)在|z|>0处收敛，在|z|>0处只有零点，即有限z平面只有零点，而全部极点都在z=0处（因果系统）
  - 结构上主要是非递归结构
- 基本结构
  - 直接型
  - 级联型
  - 线性相位型
  - 频率抽样型



[TOC]

### #6 IIR滤波器设计

##### 6.1 引言

- 数字滤波器的设计步骤
  - 按任务要求，确定滤波器性能要求
  - 用一个因果稳定的离散线性时不变的系统函数去逼近这一性能要求（#6、#7主要内容）
  - 利用有限精度算法来实现这个系统函数
  - 实际的技术实现
- 数字滤波器频率响应特性的参数
  - 幅度平方响应
  - 相位响应
  - 群延迟响应
- 设计IIR滤波器的方法
  - 找一个合适的模拟滤波器》变换成满足预定指标的数字滤波器
  - 计算机辅助设计法

##### 6.2 最小与最大相位延时系统，最小与最大相位超前系统

- 最小相位延时系统性质
  - 在幅度响应相同的所有系统中，最小相位系统具有最小的相位滞后（延时）
  - 对相同傅里叶变换幅度的各序列，最小相位序列的h~min~(0)最大
  - ...

##### 6.3 全通系统

- 全通系统是指系统频率响应的幅度在所有频率ω下均为1或某一常数的系统
- 全通系统的应用

##### 6.4 用模拟滤波器设计IIR数字滤波器

##### 6.5 冲激响应不变法

- 变换原理
  - 冲激响应不变法是使数字滤波器的单位冲激响应序列h(n)模仿模拟器的单位冲激响应H~a~(t)。将模拟滤波器的单位冲激响应加以等间隔抽样，使h(n)正好等于h~a~(t)的抽样值
- 混叠失真
  - 数字滤波器的频率响应是模拟滤波器频率响应的周期延拓
- 模拟滤波器的数字化方法
- 优缺点

##### 6.7 双线性变换法

- 双线性变换法：克服产生频率响应的混叠失真这一缺点
- 原理
- 变换常数c的选择
- 逼近的情况
- 优缺点
- 模拟滤波器数字化方法
- 用列表格的方法来完成双线性变换设计



[TOC]

### #7 FIR数字滤波器的设计

##### 7.1 引言

- 设计和优势
  - 真正线性的
  - 没有稳定性问题，相对容易设计
  - 高效的
